\documentclass[../3.tex]{subfiles}
\begin{document}
   In this section we discuss the symmetries of a classification $C$ from the space of signals $\mc{S}$ to some space $\mc{L}$.
   For instance in image classification the space of signals is the space of functions defined on im two dimensional grid,
   and a possible and popular classification task is the recognition of the object in the image.
 

    \begin{defn}
        We define a \ii{classification} to be a function $C : \mc{S} \to \mc{L}$ from the signal space into some set $\mc{L}$.
    \end{defn}

    In the case of image classification $\mc{L}$ is a finite set of labels.

    We now want give a more formal definition of symmetry of a classification.

    \begin{defn}
        Let $C : \mc{S} \to \mc{L}$ be a classification, we define a \ii{symmetry} of $C$ to be an invertible function
        $g : \mc{S} \to \mc{S}$ such that 
        \[ C[g(\phi)] = C[\phi] \quad \forall \phi \in \mc{S}. \]
    \end{defn}

    We will denite the set of these symmetries as $S_C := \{ g : \mc{S} \to \mc{S} \; : \; C[g(\phi)] = C[\phi] \;  \forall \phi \in \mc{S}\}$

    \begin{prop}
        The set of symmetries $S_C$ of the classification $C$ is a group with the usual function composition.
    \end{prop} 
    \begin{proof}
        We shall prove that this set with respect to $\circ$ satisfies all the group properties.
        \begin{enumerate}[(i)]
            \item The operation $\circ$ is associative.
            \item Let $\text{id}_\mc{S} : \mc{S} \to \mc{S}$ be the identity on $\mc{S}$, namely $\text{id}_\mc{S}(\phi) = \phi$ for all $\phi \in \mc{S}$,
                then $\text{id}_\mc{S} \in S_C$.
            \item Let $g,g' \in S_C$, we have that $C[(g\circ g')(\phi)] = C[\phi]$, therefore $(g \circ g') \in S_C$.
            \item Let $g \in S_C$ then $C[g^{-1}(\phi)] = C[\phi]$, since $C[(g \circ g^{-1})(\phi)] = C[(\phi)] = C[g^{-1}(\phi)]$. \qedhere
        \end{enumerate}
    \end{proof}

    It is important to notice that in order to define a symmetry we need to choose a classification, namely there is no a priori symmetry in the data until
    we specify what we want to do with it.\\

    % In order to deal with groups in an efficient way we need to define what the \ii{generators} of the group are.

    % \begin{defn}
    %     Let $G$ be a group, and let $S \subset G$, if every element of $G$ can be written as composition of elements of $S$ and their inverses,
    %     then the elements of $S$ are called \ii{generators} of the group $G$.
    % \end{defn}
    \hfill \\
    Another way to see how the group acts on data is to see the group itself as an abstract object and define an \ii{action} of this group on the domain
    of the signals.

    \begin{defn}
        Let $G$ be a group and $\Omega$ a set, then we define \ii{action} of $G$ on $\Omega$ a mapping $. \; : G \times \Omega \to \Omega$, such that
        $(g,x) \mapsto g.x$ and for all $g,h \in G$ $g.(h.x) = (g \circ h).x$, i.e. it is compatible with the group operation, and such that
        $1.x = x$ for all $x \in \Omega$, where $1$ is the group identity.
    \end{defn}

    From a group action on the domain $\Omega$ we can obtain a group action on the signal space.

    \begin{prop}
        Let $G$ be a group and let $\mc{S}$ be the space of signals from $\Omega$ to $V$, then for all $\phi \in \mc{S}$ and for all $g \in G$ we have that
        \[ (g.\phi)(x) := \phi(g^{-1}.x) \quad \forall x \in \Omega, \]
        is an action of $G$ on $\mc{S}$.
    \end{prop}
    \begin{proof}
        We can see that $g.(h.\phi)(x) = g.\phi(h^{-1}.x) = \phi((g^{-1} \circ h^{-1}).x) = ((g \circ h).\phi)(x). \qedhere$
    \end{proof}

    An important class of group actions is that of \ii{linear} group actions, also called \ii{group representations}.
    A linear group action has the additional property $g.(\lambda \phi + \mu \psi) = \lambda g.\phi + \mu g.\psi$, for all $\phi,\psi$ in the set
    on which the group acts. A linear group action allows us to associate to an element $g$ of $G$ a $n \times n$ invertible matrix.

    \begin{defn}
        Let $G$ be a group, we define an $n$-dimensional representation of $G$ to be a homomorphism $\rho : G \to GL(n)$\footnote{GL(n) is the group of $n \times n$ invertible matrices.}.
    \end{defn}
    $\text{circ}(0,1,0,\dots,0)$
    An important role in geometric deep learning is played by the so called \ii{group equivariant} and \ii{group invariant} functions.

    \begin{defn}
        Let $\mc{C}$ be some set, a function $f : \mc{S} \to \mc{C}$, is called \ii{$G$-invariant} if
        \[ f(\rho(g)\phi) = f(\phi) \quad \forall g \in G, \]
        where $\phi \in \mc{S}$.
   \end{defn}

   \begin{defn}
       A function $f : \mc{S} \to \mc{S}$ is called \ii{$G$-equivariant} if 
       \[ f(\rho(g)\phi) = \rho(g)f(\phi) \quad \forall g \in G, \]
       where $\phi \in \mc{S}$.
   \end{defn}

   An example of equivariance can be seen recalling example \ref{exa:circ}.

   {\color{red}
   \begin{exa}
        Se c'Ã¨ tempo faccio l'esempio di equivarianza utilizzando tutta la teoria della sezione, con un intervallo I che ha 
        equivariante rispetto al gruppo ciclico, ma non so se ci resco
   \end{exa}
   }

\end{document}